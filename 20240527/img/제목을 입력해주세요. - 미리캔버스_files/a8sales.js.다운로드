/*!
The punycode class and String.fromCodePoint method are:

Copyright Mathias Bynens <https://mathiasbynens.be/>

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
var maxInt_a8=2147483647,base_a8=36,tMin_a8=1,tMax_a8=26,skew_a8=38,damp_a8=700,initialBias_a8=72,initialN_a8=128,delimiter_a8="-",regexPunycode_a8=/^xn--/,regexNonASCII_a8=/[^\0-\x7E]/,regexSeparators_a8=/[\x2E\u3002\uFF0E\uFF61]/g;String.fromCodePoint||function(){var e=function(){try{var e={},o=Object.defineProperty,r=o(e,e,e)&&o}catch(e){}return r}(),s=String.fromCharCode,l=Math.floor,o=function(){var e,o,r=[],t=-1,a=arguments.length;if(!a)return"";for(var i="";++t<a;){var n=Number(arguments[t]);if(!isFinite(n)||n<0||1114111<n||l(n)!=n)throw RangeError("Invalid code point: "+n);n<=65535?r.push(n):(e=55296+((n-=65536)>>10),o=n%1024+56320,r.push(e,o)),(t+1==a||16384<r.length)&&(i+=s.apply(null,r),r.length=0)}return i};e?e(String,"fromCodePoint",{value:o,configurable:!0,writable:!0}):String.fromCodePoint=o}();var errors_a8={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin_a8=base_a8-tMin_a8,floor_a8=Math.floor,stringFromCharCode_a8=String.fromCharCode;function error_A8(e){throw new RangeError(errors_a8[e])}function map_A8(e,o){for(var r=[],t=e.length;t--;)r[t]=o(e[t]);return r}function mapDomain_A8(e,o){var r=e.split("@"),t="";return 1<r.length&&(t=r[0]+"@",e=r[1]),t+map_A8((e=e.replace(regexSeparators_a8,".")).split("."),o).join(".")}function ucs2decode_A8(e){for(var o=[],r=0,t=e.length;r<t;){var a=e.charCodeAt(r++);if(55296<=a&&a<=56319&&r<t){var i=e.charCodeAt(r++);56320==(64512&i)?o.push(((1023&a)<<10)+(1023&i)+65536):(o.push(a),r--)}else o.push(a)}return o}var ucs2encode_A8=function(e){return String.fromCodePoint.apply(null,e)},basicToDigit_A8=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:base_a8},digitToBasic_A8=function(e,o){return e+22+75*(e<26)-((0!=o)<<5)},adapt_A8=function(e,o,r){var t=0;for(e=r?floor_a8(e/damp_a8):e>>1,e+=floor_a8(e/o);baseMinusTMin_a8*tMax_a8>>1<e;t+=base_a8)e=floor_a8(e/baseMinusTMin_a8);return floor_a8(t+(baseMinusTMin_a8+1)*e/(e+skew_a8))},decode_A8=function(e){var o=[],r=e.length,t=0,a=initialN_a8,i=initialBias_a8,n=e.lastIndexOf(delimiter_a8);n<0&&(n=0);for(var s=0;s<n;++s)128<=e.charCodeAt(s)&&error_A8("not-basic"),o.push(e.charCodeAt(s));for(var l=0<n?n+1:0;l<r;){for(var c=t,u=1,_=base_a8;;_+=base_a8){r<=l&&error_A8("invalid-input");var d=basicToDigit_A8(e.charCodeAt(l++));(base_a8<=d||d>floor_a8((maxInt_a8-t)/u))&&error_A8("overflow"),t+=d*u;var m=_<=i?tMin_a8:i+tMax_a8<=_?tMax_a8:_-i;if(d<m)break;var g=base_a8-m;u>floor_a8(maxInt_a8/g)&&error_A8("overflow"),u*=g}var p=o.length+1;i=adapt_A8(t-c,p,0==c),floor_a8(t/p)>maxInt_a8-a&&error_A8("overflow"),a+=floor_a8(t/p),t%=p,o.splice(t++,0,a)}return String.fromCodePoint.apply(null,o)},encode_A8=function(e){for(var o=[],r=(e=ucs2decode_A8(e)).length,t=initialN_a8,a=0,i=initialBias_a8,n=0;n<r;n++)e[n]<128&&o.push(stringFromCharCode_a8(e[n]));var s=o.length,l=s;for(s&&o.push(delimiter_a8);l<r;){var c=maxInt_a8;for(n=0;n<r;n++)e[n]>=t&&e[n]<c&&(c=e[n]);var u=l+1;c-t>floor_a8((maxInt_a8-a)/u)&&error_A8("overflow"),a+=(c-t)*u,t=c;for(n=0;n<r;n++)if(e[n]<t&&++a>maxInt_a8&&error_A8("overflow"),e[n]==t){for(var _=a,d=base_a8;;d+=base_a8){var m=d<=i?tMin_a8:i+tMax_a8<=d?tMax_a8:d-i;if(_<m)break;var g=_-m,p=base_a8-m;o.push(stringFromCharCode_a8(digitToBasic_A8(m+g%p,0))),_=floor_a8(g/p)}o.push(stringFromCharCode_a8(digitToBasic_A8(_,0))),i=adapt_A8(a,u,l==s),a=0,++l}++a,++t}return o.join("")},toUnicode_A8=function(e){return mapDomain_A8(e,function(e){return regexPunycode_a8.test(e)?decode_A8(e.slice(4).toLowerCase()):e})},toASCII_A8=function(e){return mapDomain_A8(e,function(e){return regexNonASCII_a8.test(e)?"xn--"+encode_A8(e):e})},punycode_A8={version:"2.1.0",ucs2:{decode:ucs2decode_A8,encode:ucs2encode_A8},decode:decode_A8,encode:encode_A8,toASCII:toASCII_A8,toUnicode:toUnicode_A8},px_domain_a8=function(e){return e&&e.coupon?"https://8pon.a8.net/tracking/v1.0":"https://px.a8.net"},a8lineConfig={endpoint:"https://a8line-friendship.a8.net"},logLevelConfig_a8={DEBUG:!1,INFO:!0,ERROR:!0};function logLevel_A8(e){if(!e||""===e)return!1;var o=logLevelConfig_a8[e];return o||!1}var cookie_expires_a8=function(){return 3653},cookies_keep_limit_a8=function(){return 10},cookies_path_a8=function(){return"/"},stoplog_a8=function(){for(var e=document.getElementsByTagName("script"),o=0;o<e.length;o++){var r=e[o].getAttribute("data-a8stoplog");if(r)return r}};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var getUTCtime_A8=function(e){var o=new Date;return o.setDate(o.getDate()+e),o.toUTCString()},logPrinter_A8=function(e,o){!stoplog_a8()&&window.console&&"function"==typeof window.console.log&&logLevel_A8(o)&&console.log("["+o+"] "+e)};function getHosts_A8(){return punycode_A8.toASCII(location.hostname).split(".")}function getPrimaryDomain_a8(e){logPrinter_A8("primaryDomain\u306e\u53d6\u5f97\u3092\u958b\u59cb\u3057\u307e\u3059\u3002","DEBUG");for(var o=getHosts_A8(),r="",t=Math.random(),a=2;a<=o.length;a++){if(r=a<o.length?"."+o.slice(-a).join("."):o.slice(-a).join("."),docCookies_A8.setItem(e,t,getUTCtime_A8(cookie_expires_a8()),cookies_path_a8(),r),docCookies_A8.getItem(e)==t)return logPrinter_A8("cookie\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f (domain :"+r+")","DEBUG"),logPrinter_A8("\u5229\u7528\u53ef\u80fd\u306a primaryDomain: "+r+".","DEBUG"),docCookies_A8.removeItem(e,cookies_path_a8(),r),r;logPrinter_A8("cookie\u306e\u4fdd\u5b58\u306b\u5931\u6557\u3057\u307e\u3057\u305f (domain :"+r+")","DEBUG")}logPrinter_A8("\u6709\u52b9\u306a\u30c9\u30e1\u30a4\u30f3\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u3067Cookie\u306e\u4fdd\u5b58\u3068\u524a\u9664\u3092\u884c\u306a\u3063\u3066\u304f\u3060\u3055\u3044\u3002","DEBUG")}function validPid(e){return logPrinter_A8("pid\u306e\u691c\u8a3c\u3092\u958b\u59cb\u3057\u307e\u3059 "+e,"DEBUG"),"string"==typeof e&&15==e.length}function validEid(e){return logPrinter_A8("eid\u306e\u691c\u8a3c\u3092\u958b\u59cb\u3057\u307e\u3059 "+e,"DEBUG"),"string"==typeof e&&12==e.length}function validEno(e){return logPrinter_A8("eno\u306e\u691c\u8a3c\u3092\u958b\u59cb\u3057\u307e\u3059 "+e,"DEBUG"),"string"==typeof e&&2==e.length}function validOrderNumber(e){return logPrinter_A8("orderNumber\u306e\u691c\u8a3c\u3092\u958b\u59cb\u3057\u307e\u3059 "+e,"DEBUG"),"string"==typeof e&&""!==e&&""!==e.trim()}function createOrderNumber(){var e=new Date,o="null-"+(""+e.getFullYear()+(e.getMonth()+1)+(e.getDate()<10?"0"+e.getDate():e.getDate())+(e.getHours()<10?"0"+e.getHours():e.getHours())+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds()))+"-"+("0000"+Math.floor(1e4*Math.random())).slice(-4);return logPrinter_A8("orderNumber\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f "+o,"DEBUG"),o}function validTotalPrice(e){return logPrinter_A8("totalPrice\u306e\u691c\u8a3c\u3092\u958b\u59cb\u3057\u307e\u3059 "+e,"DEBUG"),"number"==typeof e}function addQueryParam(e,o,r){logPrinter_A8("\u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u307e\u3059 urlString:"+e+", paramName:"+o+", paramValue:"+r,"DEBUG");var t=new URL(e);return t.searchParams.append(o,r),logPrinter_A8("\u30af\u30a8\u30ea\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u8ffd\u52a0\u3057\u307e\u3057\u305f "+t,"DEBUG"),t.toString()}function checkCurrency_A8(e){return"string"==typeof e&&!0===/^[A-Za-z]/.test(e)&&3==e.length?e:(logPrinter_A8("currency = "+e+": \u901a\u8ca8\u5358\u4f4d\u6307\u5b9a\u304c\u5b58\u5728\u3057\u306a\u3044\u304b\u3001\u6b63\u3057\u304f\u8a8d\u8b58\u3055\u308c\u306a\u304b\u3063\u305f\u305f\u3081\u300cJPY\u300d\u3092\u9069\u7528\u3057\u307e\u3059\u3002","DEBUG"),"JPY")}function genarateSIparam_A8(e){if("number"!=typeof e.price)return"";var o,r,t=e.price;return o="number"==typeof e.quantity&&0<=e.quantity&&!1===/^-?[0-9]+\.[0-9]+$/.test(e.quantity)?Math.floor(e.quantity):1,r="string"==typeof e.code&&""!==e.code?e.code:"a8","&si="+t+"-"+o+"-"+("number"==typeof e.total_price&&""!==e.total_price?e.total_price:t*o)+"-"+r}function genaratePrioritySIparam_A8(e){if("number"!=typeof e.price)return"";var o,r,t=e.price;return o="number"==typeof e.quantity&&0<=e.quantity&&!1===/^-?[0-9]+\.[0-9]+$/.test(e.quantity)?Math.floor(e.quantity):1,r="string"==typeof e.code&&""!==e.code?e.code:"a8","&si="+t+"-"+o+"-"+(t*o-e.discount_price)+"-"+r}function getIndex(e,o,r){for(var t=0;t<o.length;t++)if(o[t][r]===e)return t;return-1}var docCookies_A8={getItem:function(e){return e&&this.hasItem(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},setItem:function(e,o,r,t,a,i){if(e&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(e)){var n="";if(r)switch(r.constructor){case Number:n=r===1/0?"; expires=Tue, 19 Jan 2038 03:14:07 GMT":"; max-age="+r;break;case String:n="; expires="+r;break;case Date:n="; expires="+r.toGMTString()}document.cookie=escape(e)+"="+escape(o)+n+(a?"; domain="+a:"")+(t?"; path="+t:"")+(i?"; secure":"")}},removeItem:function(e,o,r){if(e&&this.hasItem(e))return document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(o?"; path="+o:"")+(r?"; domain="+r:""),this.hasItem(e)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},hasLikeItem:function(e){return new RegExp("(?:^|;\\s*\\w*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\w*\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),o=0;o<e.length;o++)e[o]=unescape(e[o]);return e},keysPickup:function(e){for(var o=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),r=[],t=0,a=0;a<o.length;a++)0<=unescape(o[a].indexOf(e))&&(r[t++]=unescape(o[a]));return r}},delCookie_A8=function(e,o){return!docCookies_A8.removeItem(e,cookies_path_a8())||!docCookies_A8.removeItem(e,cookies_path_a8(),o)},callDelCookie_A8=function(e,o){for(var r=punycode_A8.toASCII(location.hostname).split("."),t="",a=r.length-1;0<=a;a--)if(t="."+r[a]+t,delCookie_A8(e,t))return!0;return!1},getCookie_A8=function(e,o,r){var t=e;if(o&&(t+="_"+o),docCookies_A8.hasItem(t))return r?docCookies_A8.getItem(t):t;if(docCookies_A8.hasLikeItem(t)){var a=docCookies_A8.keysPickup(t);return r?docCookies_A8.getItem(a[a.length-1]):a[a.length-1]}return docCookies_A8.hasItem(e)?r?docCookies_A8.getItem(e):e:void 0},getParamValue_A8=function(e){var o=window.location.search.split("?");if(1<o.length)for(var r=o[1].split("&"),t=0;t<r.length;t++){var a=r[t].split("=");if(a[0]===e)return a[1]}return logPrinter_A8("there is not a8 parameter","INFO"),""},getPid_A8=function(e){var o=e.slice(-15);return/s\d{14}/.test(o)?o:""};function hashCode_a8(e){var o=0;if(!e||"string"!=typeof e||0==e.length)return logPrinter_A8("hashcode value is invalid:"+e,"DEBUG"),o;for(i=0;i<e.length;i++)char=e.charCodeAt(i),o=(o<<5)-o+char,o&=o;return o}var A8salesCookieRepository=function(){var n="_A8Sales_",s=",",o="_a8rp_",l=",",i=getPrimaryDomain_a8("domainTest_A8");function c(e,o){if(!e)return logPrinter_A8("[saveCookieForPrimaryDomain_A8] invalid cookie name. a8CookieName:"+e,"DEBUG"),!1;if(void 0===o)return logPrinter_A8("[saveCookieForPrimaryDomain_A8] invalid cookie value. a8CookieValue:"+o,"DEBUG"),!1;var r=getUTCtime_A8(cookie_expires_a8()),t=cookies_path_a8();if(docCookies_A8.setItem(e,o,r,t,i),logPrinter_A8("[saveCookieForPrimaryDomain_A8] try save cookie (key:"+e+", domain:"+i+", expires:"+r.toString()+", val:"+o+")","DEBUG"),d(e,o))return logPrinter_A8("[saveCookieForPrimaryDomain_A8] success save cookie (key:"+e+", domain:"+i+", expires:"+r.toString()+", val:"+o+")","DEBUG"),!0;_(e)||(docCookies_A8.setItem(e,o,r,t,void 0),logPrinter_A8("[saveCookieForPrimaryDomain_A8] fail save cookie for primary domain, try current domain for save cookie (key:"+e+", expires:"+r.toString()+", val:"+o+")","DEBUG"));var a=d(e,o);return logPrinter_A8("[saveCookieForPrimaryDomain_A8] save cookie. result:"+a+", a8CookieName:"+e+", a8CookieValue:"+o,"DEBUG"),a}function u(e){if(!e)return logPrinter_A8("[removeCookieForPrimaryDomain_A8] invalid cookie parameter. a8CookieName:"+e,"DEBUG"),!1;var o=cookies_path_a8();if(docCookies_A8.removeItem(e,o,i),logPrinter_A8("[removeCookieForPrimaryDomain_A8] try remove cookie (key:"+e+", domain:"+i+")","DEBUG"),!_(e))return logPrinter_A8("[removeCookieForPrimaryDomain_A8] success remove cookie (key:"+e+", domain:"+i+")","DEBUG"),!0;_(e)&&(docCookies_A8.removeItem(e,o,void 0),logPrinter_A8("[removeCookieForPrimaryDomain_A8] fail remove cookie for primary domain, try remove domain for current domain (key:"+e+")","DEBUG"));var r=_(e);return logPrinter_A8("[removeCookieForPrimaryDomain_A8] remove cookie. result:"+r+", a8CookieName:"+e,"DEBUG"),r}function _(e){return docCookies_A8.hasItem(e)}function d(e,o){return docCookies_A8.hasItem(e)&&docCookies_A8.getItem(e)===o}function m(){if(!docCookies_A8.hasItem(n))return logPrinter_A8("[a8SalesCookieNames] not exists A8sales meta Cookie.","DEBUG"),[];var e=docCookies_A8.getItem(n);if(!e)return logPrinter_A8("[a8SalesCookieNames] not exists A8sales meta Cookie Value.","DEBUG"),[];var o=e.split(s);return logPrinter_A8("[a8SalesCookieNames] get a8salesCookieNames:"+o,"DEBUG"),o}function g(e){return o+e}function p(e){var o=g(e);if(!docCookies_A8.hasItem(o))return logPrinter_A8("[a8RepeatCookie] not exists A8Repeat Cookie.","DEBUG"),[];var r=docCookies_A8.getItem(o);if(!r||""===r)return logPrinter_A8("[a8RepeatCookie] has not value A8Repeat Cookie.","DEBUG"),[];var t=r.split(l);return logPrinter_A8("[a8RepeatCookie] get order numbers hashcode: "+t,"DEBUG"),t}function A(e,o){var r=p(e);if(!r||r.length<=0)return logPrinter_A8("[a8RepeatCookie] has not orderNumbers","DEBUG"),!1;var t=hashCode_a8(o)+"";logPrinter_A8("[a8RepeatCookie] convert orderNumber hashcode: "+t,"DEBUG");for(var a=0;a<r.length;a++){var i=r[a];if(t===i)return logPrinter_A8("[a8RepeatCookie] match order number: "+t+" = "+i,"DEBUG"),!0}return logPrinter_A8("[a8RepeatCookie] not match order number: "+o+", "+r,"DEBUG"),!1}return{findA8salesCookies:function(){return function(e){if(!e||e.length<=0)return logPrinter_A8("[a8salesCookies] not exists a8sales cookie names.","DEBUG"),[];for(var o=[],r=0;r<e.length;r++){var t=e[r];if(docCookies_A8.hasItem(t)){var a=docCookies_A8.getItem(t);if(a&&""!==a){var i={a8sales_cookie_name:t,a8sales_cookie_value:a};logPrinter_A8("[a8salesCookies] remake a8sales cookie:"+i,"DEBUG"),o.push(i)}else logPrinter_A8("[a8salesCookies] not exists a8sales cookie of value:"+a+", name:"+t,"DEBUG")}else logPrinter_A8("[a8salesCookies] not exists a8sales cookie of name:"+t,"DEBUG")}return logPrinter_A8("[a8salesCookies] build a8sales cookies: "+o,"DEBUG"),o}(m())},existsA8salesCookies:function(){var e=m();return e&&0<e.length},addA8salesCookie:function(e,o){return function(e){if(!e||""===e)return logPrinter_A8("[addA8salesMetaCookie] invalid parameter a8salesCookieName. a8salesCookieName:"+e,"DEBUG"),!1;var o=m();if(!o||o.length<=0)return c(n,e),logPrinter_A8("[addA8salesMetaCookie] a8sales meta cookie not exists, create a8sales meta cookie. a8saleCookieName:"+e,"DEBUG"),d(n,e);for(var r=!1,t=0;t<o.length;t++){var a=o[t];if(a===e){logPrinter_A8("[addA8salesMetaCookie] exists saved a8sales cookie name. savedA8salesCookieName:"+a,"DEBUG"),r=!0;break}}r||(o.push(e.trim()),logPrinter_A8("[addA8salesMetaCookie] not exists a8sales cookie name, add a8sales cookie name. savedA8salesCookieName:"+a,"DEBUG"));var i=o.join(s);return logPrinter_A8("[addA8SalesMetaCookie] add a8salesCookieName(if not saved). a8metaCookieValue:"+i+"a8salesCookieNameList:"+o,"DEBUG"),c(n,i),d(n,i)}(e)?function(e,o){return c(e,o),d(e,o)}(e,o)?(logPrinter_A8("[addA8salesCookies] success save a8sales and a8meta cookie. a8salesCookieName:"+e+", a8salesCookieValue:"+o,"DEBUG"),!0):(logPrinter_A8("[addA8salesCookies] fail save a8sales cookie. a8salesCookieName:"+e+", a8salesCookieValue:"+o,"DEBUG"),!1):(logPrinter_A8("[addA8salesCookies] fail add a8meta cookie. a8salesCookieName:"+e,"DEBUG"),!1)},removeA8salesCookie:function(e){var o=function(e){if(!e||""===e)return logPrinter_A8("[removeA8salesMetaCookie] invalid parameter a8salesCookieName. a8salesCookieName:"+e,"DEBUG"),!1;var o=m();if(!o||o.length<=0)return logPrinter_A8("[removeA8salesMetaCookie] a8sales meta cookie not exists. a8saleCookieName:"+e,"DEBUG"),!0;for(var r=[],t=0;t<o.length;t++){var a=o[t];a!==e?r.push(a.trim()):logPrinter_A8("[removeA8salesMetaCookie] exists saved a8sales cookie name. savedA8salesCookieName:"+a,"DEBUG")}var i=r.join(s);return logPrinter_A8("[removeA8salesMetaCookie] add a8salesCookieName(if not saved). a8metaCookieValue:"+i+" a8salesCookieNameList:"+o,"DEBUG"),u(n),c(n,i),d(n,i)}(e);logPrinter_A8("[removeA8salesCookie] remove a8meta cookie. result:"+o+" a8salesCookieName:"+e,"DEBUG");var r=function(e){return u(e),!_(e)}(e);return logPrinter_A8("[removeA8salesCookie] remove a8sales cookie. result:"+r+" a8salesCookieName:"+e,"DEBUG"),r},updateExpiresA8salesCookie:function(e){var o=docCookies_A8.getItem(e);return c(e,o)?(logPrinter_A8("[updateExpiresA8salesCookie] success update a8sales cookie. a8salesCookieName:"+e+", a8salesCookieValue:"+o,"DEBUG"),d(e,o)):(logPrinter_A8("[updateExpiresA8salesCookie] fail update a8sales cookie, fail save a8sales cookie. a8salesCookieName:"+e+", a8salesCookieValue:"+o,"DEBUG"),!1)},updateA8salesMetaCookie:function(){var e=this.updateExpiresA8salesCookie(n);return logPrinter_A8("[updateA8salesMetaCookie] update a8sales meta cookie. result:"+e,"DEBUG"),e},existsRepeatOrderNumber:function(e,o){return A(e,o)},saveRepeatOrderNumber:function(e,o){!function(e,o){var r=hashCode_a8(o);if(logPrinter_A8("[a8RepeatCookie] convert orderNumber hashcode: "+r,"DEBUG"),0!==r&&"0"!==r){var t=p(e);if(!t||t.length<=0){var a=c(i=g(e),r);logPrinter_A8("[a8RepeatCookie] save a8repeat cookie orderNumber. result:"+a+", hashcode:"+r,"DEBUG")}else if(A(e,o))logPrinter_A8("[a8RepeatCookie] orderNumber is exists.","DEBUG");else{t.push(r);var i=g(e),n=t.join(l);a=c(i,n),logPrinter_A8("[a8RepeatCookie] save a8repeat cookie orderNumber list. result:"+a+", orderNumbers:"+n,"DEBUG")}}else logPrinter_A8("[a8RepeatCookie] convert orderNumber hashcode is invalid: "+o+", "+r,"ERROR")}(e,o)}}};function cookieSetting_A8(e,o){if(logPrinter_A8("start set cookie","INFO"),!o||!e)return logPrinter_A8("url does not have a8 parameter","DEBUG"),!1;if(!getPid_A8(o))return logPrinter_A8("a8 parameter does not have pid!","DEBUG"),!1;var r=new A8salesCookieRepository,t=docCookies_A8.keysPickup(e);if(t.length>=cookies_keep_limit_a8()){var a=t[0];logPrinter_A8("limit over. most old cookie is ="+a+"="+docCookies_A8.getItem(a),"DEBUG"),r.removeA8salesCookie(a)}var i=e+"_"+getPid_A8(o);return r.addA8salesCookie(i,o)?i:""}function a8sales(e){logPrinter_A8("a8sales() start","INFO");var o=document.getElementById("a8sales");if(o){var r=e.coupon&&0<e.coupon.length,t="",a=px_domain_a8({coupon:r});"string"==typeof e.pid&&15==e.pid.length?t=a+"/a8fly/earnings?pid="+e.pid:"string"==typeof e.eid&&12==e.eid.length?t="string"==typeof e.eno&&2==e.eno.length?a+"/a8fly/earnings?eid="+e.eid+"&eno="+e.eno:a+"/a8fly/earnings?eid="+e.eid:e.pid?"string"!=typeof e.pid?logPrinter_A8(e.pid+": pid\u304c\u6587\u5b57\u5217\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002","ERROR"):15!=e.pid.length&&logPrinter_A8(e.pid+": pid\u306e\u6841\u6570\u304c\u7570\u306a\u308a\u307e\u3059\u3002","ERROR"):e.eid?"string"!=typeof e.eid?logPrinter_A8(e.eid+": eid\u304c\u6587\u5b57\u5217\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002","ERROR"):12!=e.eid.length&&logPrinter_A8(e.eid+": eid\u306e\u6841\u6570\u304c\u7570\u306a\u308a\u307e\u3059","ERROR"):logPrinter_A8("pid\u53ca\u3073eid\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u304a\u308a\u307e\u305b\u3093\u3002","ERROR");var i="",n=e.items.reduce(function(e,o){return e+o.price*o.quantity},0),s=[];if(void 0===e.items){if("number"!=typeof e.price||"number"!=typeof e.quantity)return"number"!=typeof e.price&&logPrinter_A8("price = "+e.price+": \u5546\u54c1\u5358\u4fa1\u306e\u5165\u529b\u5024\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","ERROR"),"number"!=typeof e.quantity&&logPrinter_A8("quantity = "+e.quantity+": \u5546\u54c1\u500b\u6570\u306e\u5165\u529b\u5024\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","ERROR"),void logPrinter_A8("\u6b63\u5e38\u306a\u5024\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002","INFO");i=genarateSIparam_A8({code:e.code,price:e.price,quantity:e.quantity,total_price:e.total_price})}else{for(var l=0;l<e.items.length;l++)if(null!=e.items[l]){if("number"!=typeof e.items[l].price||"number"!=typeof e.items[l].quantity)return"number"!=typeof e.items[l].price&&logPrinter_A8("price = "+e.items[l].price+": \u5546\u54c1\u5358\u4fa1\u306e\u5165\u529b\u5024\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","ERROR"),"number"!=typeof e.items[l].quantity&&logPrinter_A8("quantity = "+e.items[l].quantity+": \u5546\u54c1\u500b\u6570\u306e\u5165\u529b\u5024\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","ERROR"),void logPrinter_A8("\u6b63\u5e38\u306a\u5024\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002","INFO");if(void 0===e.total_price)i+=genarateSIparam_A8(e.items[l]);else if("number"==typeof e.total_price)if("calc"!=e.amount_priority&&"total_price"===e.amount_priority&&e.amount_priority){if("total_price"==e.amount_priority){var c=n-e.total_price,u=e.items[l].price*e.items[l].quantity/n,_=Math.round(u*c);s.push({code:e.items[l].code,price:e.items[l].price,quantity:e.items[l].quantity,discount_price:_})}}else i+=genarateSIparam_A8(e.items[l]);else i+=genarateSIparam_A8(e.items[l]),logPrinter_A8("total_price = "+e.total_price+": \u5408\u8a08\u91d1\u984d\u306e\u5165\u529b\u5024\u304c\u7570\u306a\u308a\u307e\u3059\u3002\u534a\u89d2\u6570\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","INFO")}if("number"==typeof e.total_price&&"total_price"==e.amount_priority){var d=s.map(function(e){return e.discount_price}),m=Math.max.apply(null,d),g=s.reduce(function(e,o){return e+o.discount_price},0);if(c!==g){var p=g-c,A=getIndex(m,s,"discount_price");s[A].discount_price=s[A].discount_price-p}for(l=0;l<s.length;l++)i+=genaratePrioritySIparam_A8(s[l])}}var k=checkCurrency_A8(e.currency),f=getCookie_A8("_a8",e.pid?e.pid:e.eid,"value"),v=getCookie_A8("_a8",e.pid?e.pid:e.eid);if(!i)return logPrinter_A8("si = "+i+": si\u5024\u306b\u6b63\u3057\u3044\u5024\u304c\u5165\u529b\u3067\u304d\u3066\u304a\u308a\u307e\u305b\u3093\u3002a8sales\u306eitems\u306e\u78ba\u8a8d\u3092\u3057\u3066\u304f\u3060\u3055\u3044\u3002","ERROR"),void logPrinter_A8("\u6b63\u5e38\u306a\u5024\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002","INFO");if(!t)return logPrinter_A8("\u6210\u679c\u30bf\u30b0\u306eURL\u306e\u751f\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002","ERROR"),void logPrinter_A8("\u6b63\u5e38\u306a\u5024\u304c\u53d6\u5f97\u3067\u304d\u306a\u3044\u305f\u3081\u3001\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002\u8a2d\u5b9a\u5024\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002","INFO");var C="string"==typeof e.order_number&&""!==e.order_number?e.order_number.trim():"",P="";if("string"==typeof e.order_number&&""!==e.order_number&&""!==C)P=e.order_number;else{var h=new Date;P="null-"+(""+h.getFullYear()+(h.getMonth()+1)+(h.getDate()<10?"0"+h.getDate():h.getDate())+(h.getHours()<10?"0"+h.getHours():h.getHours())+(h.getMinutes()<10?"0"+h.getMinutes():h.getMinutes())+(h.getSeconds()<10?"0"+h.getSeconds():h.getSeconds()))+"-"+("0000"+Math.floor(1e4*Math.random())).slice(-4),e.order_number_custom=P,logPrinter_A8("\u6ce8\u6587\u756a\u53f7\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002null-\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7-\u4e71\u6570\u3092\u81ea\u52d5\u751f\u6210\u3057\u307e\u3059\u3002","INFO"),logPrinter_A8("order_number = "+P,"INFO")}var y="";if(void 0===e.total_price)y="&a8_tp=not_exist&via=from_js";else if("number"==typeof e.total_price)if(e.total_price!==n)y="&a8_tp_diff="+(n-e.total_price)+"&a8_sales_total="+e.total_price+"&a8_item_total="+n+"&via=from_js";else y="&a8_tp_int="+e.total_price+"&via=from_js";else y="&a8_tp_str="+e.total_price+"&via=from_js";if(void 0===f)var E=t+"&so="+P+i+"&currency="+k+"&type=image"+y;else E=t+"&so="+P+i+"&currency="+k+"&type=image&a8="+f+y;e.si=i,r&&(E=E+"&code="+e.coupon,logPrinter_A8("[a8coupon] \u30af\u30fc\u30dd\u30f3\u30b3\u30fc\u30c9\u304c\u6709\u52b9\u3067\u3059:"+E,"DEBUG"));var D=function(e,o){var r=document.createElement("img");r.setAttribute("src",e),r.setAttribute("width","0"),r.setAttribute("height","0"),r.setAttribute("border","0"),o.appendChild(r),"undefined"!==e&&logPrinter_A8("a8sales() is SUCCESS. URL="+e,"INFO")},I=new A8salesCookieRepository;if(!e.repeat){D(E,o);var b=I.removeA8salesCookie(v);return logPrinter_A8("remove cookie -> "+v+"="+f,"INFO"),logPrinter_A8("Is not there "+v+" cookie ? : "+b,"INFO"),void logPrinter_A8("a8sales() end","INFO")}var U=e.pid?e.pid:e.eid;if(I.existsRepeatOrderNumber(U,P))return logPrinter_A8("[a8repeat] exists order number. "+P,"INFO"),void logPrinter_A8("a8sales() end","INFO");D(E+="&a8_repeat=true",o),I.saveRepeatOrderNumber(U,P),logPrinter_A8("[a8repeat] create a8 img tag, save order number. "+P,"INFO"),logPrinter_A8("a8sales() end","INFO")}else logPrinter_A8("span\u30bf\u30b0\u304c\u5b58\u5728\u3057\u307e\u305b\u3093\u3002\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002","ERROR")}function updateCookieExpire_A8(){logPrinter_A8("[updateCookieExpire_A8] start","INFO");var e=new A8salesCookieRepository;if(e.existsA8salesCookies()){for(var o=e.findA8salesCookies(),r=0;r<o.length;r++){var t=o[r],a=t.a8sales_cookie_name,i=t.a8sales_cookie_value;logPrinter_A8("[updateCookieExpire_A8] get a8cookie, try update expires. key:"+a+", value:"+i,"DEBUG");var n=e.updateExpiresA8salesCookie(a);logPrinter_A8("[updateCookieExpire_A8] update a8sales cookie. a8CookieName:"+a+", result:"+n,"DEBUG")}e.updateA8salesMetaCookie(),logPrinter_A8("[updateCookieExpire_A8] done.","INFO")}else logPrinter_A8("[updateCookieExpire_A8] not exists a8 cookie. exit update exipires.","INFO")}function a8lineCookieSetting(e,o){if(!e||!o)return logPrinter_A8("[a8lineCookieSetting] \u5024\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093 (cookieName:"+e+", cookieValue:"+o+")","DEBUG"),!1;var r=getPrimaryDomain_a8("domainTest_a8line"),t=getUTCtime_A8(cookie_expires_a8()),a=cookies_path_a8();if(logPrinter_A8("[a8lineCookieSetting] cookie\u3092\u8a2d\u5b9a\u3057\u307e\u3059 (key:"+e+", primaryDomain:"+r+", expires:"+t.toString()+", val:"+o+")","DEBUG"),docCookies_A8.setItem(e,o,t,a,r),docCookies_A8.hasItem(e)&&docCookies_A8.getItem(e)===o)return logPrinter_A8("[a8lineCookieSetting] cookie\u306e\u8a2d\u5b9a\u306b\u6210\u529f\u3057\u307e\u3057\u305f (key:"+e+", primaryDomain:"+r+", expires:"+t.toString()+", val:"+o+")","DEBUG"),!0;var i=docCookies_A8.hasItem(e)&&docCookies_A8.getItem(e)===o;return logPrinter_A8("[a8lineCookieSetting] cookie\u306e\u8a2d\u5b9a\u7d50\u679c:"+i+", key:"+e+", val:"+o,"DEBUG"),i}function getCookie_UserId(e,o){if(docCookies_A8.hasItem(e)&&docCookies_A8.getItem(e))return docCookies_A8.getItem(e);var r=new Date;return o+"-"+r.getFullYear()+(r.getMonth()+1)+(r.getDate()<10?"0"+r.getDate():r.getDate())+(r.getHours()<10?"0"+r.getHours():r.getHours())+(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())+(r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds())+"-"+generateRandomString(10)}function generateRandomString(e){var o=window.crypto||window.msCrypto,r=new Uint32Array(e);o.getRandomValues(r);for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/",a="",i=0;i<e;i++)a+=t[r[i]%t.length];return a}function sendStateParam(e,o,r){logPrinter_A8("[sendStateParam] state\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u4fe1\u3057\u307e\u3059 a8param:"+e+", state:"+o+", userId:"+r,"INFO");var t=a8lineConfig.endpoint+"/state";t=addQueryParam(t=addQueryParam(t=addQueryParam(t,"a8",e),"state",o),"user_id",r);var a=document.createElement("script");a.src=t,document.body.appendChild(a),logPrinter_A8("[a8lineCallback] state\u30d1\u30e9\u30e1\u30fc\u30bf\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f "+t,"INFO")}function a8createLineLoginUrl(e){logPrinter_A8("[a8createLineLoginUrl] start a8createLineLoginUrl "+JSON.stringify(e),"INFO");var o=e.state,r=e.channel_id,t=e.bot_prompt,a=e.scope_list,i="https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id="+r+"&redirect_uri="+encodeURIComponent(e.callback_url)+"&state="+o+"&bot_prompt="+t+"&scope="+a;return logPrinter_A8("[a8createLineLoginUrl] LINE login URL\u3092\u4f5c\u6210\u3057\u307e\u3057\u305f "+i,"DEBUG"),i}function a8lineSetup(e){logPrinter_A8("[a8lineSetup] a8lineSetup\u306e\u51e6\u7406\u3092\u958b\u59cb\u3057\u307e\u3059 "+JSON.stringify(e),"INFO");var o=e.pid,r=e.eid,t=e.channel_id;validPid(o)||logPrinter_A8("[a8lineSetup] pid\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 pid:"+o,"ERROR"),validEid(r)||logPrinter_A8("[a8lineSetup] eid\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 eid:"+r,"DEBUG");var a=o||r,i=getCookie_A8("_a8",a,"value");logPrinter_A8("[a8lineSetup] a8parameter\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f a8paramKey:"+a+" a8param:"+i,"DEBUG");var n="_a8_line_"+t,s=getCookie_UserId(n,t);a8lineCookieSetting(n,s);var l=generateRandomString(10);sendStateParam(i,l,s);var c=a8createLineLoginUrl({channel_id:e.channel_id,bot_prompt:e.bot_prompt,scope_list:e.scope_list,callback_url:e.callback_url,pid:o,eid:r,state:l}),u=e.selector;document.querySelector(u).href=c,logPrinter_A8("[a8lineSetup] LINE\u30ed\u30b0\u30a4\u30f3URL\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u305f "+c,"DEBUG"),logPrinter_A8("[a8lineSetup] a8lineSetup\u306e\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059 "+JSON.stringify(e),"INFO")}function a8lineCallback(e){logPrinter_A8("[a8lineCallback] a8lineCallback\u306e\u51e6\u7406\u3092\u958b\u59cb\u3057\u307e\u3059 "+JSON.stringify(e),"INFO");var o=e.pid;validPid(o)||(logPrinter_A8("[a8lineCallback] pid\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 pid:"+o,"ERROR"),o="");var r=e.eid;validEid(r)||(logPrinter_A8("[a8lineCallback] eid\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 eid:"+r,"DEBUG"),r="");var t=e.eno;validEno(t)||(logPrinter_A8("[a8lineCallback] eno\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 eno:"+t,"DEBUG"),t="");var a=e.order_number;validOrderNumber(a)||(logPrinter_A8("[a8lineCallback] order_number\u306e\u5024\u304c\u7121\u52b9\u3067\u3059 eno:"+t,"ERROR"),a=createOrderNumber());var i=checkCurrency_A8(e.currency),n=e.total_price;if(validTotalPrice(n)){var s=o||r,l=getCookie_A8("_a8",s,"value");logPrinter_A8("[a8lineCallback] a8parameter\u3092\u53d6\u5f97\u3057\u307e\u3057\u305f a8paramKey:"+s+" a8param:"+l,"DEBUG");var c=a8lineConfig.endpoint+"/friendship/earnings";c=addQueryParam(c=addQueryParam(c=addQueryParam(c=addQueryParam(c=addQueryParam(c=addQueryParam(c=addQueryParam(c=addQueryParam(c,"callback_url",window.location.href),"a8",l),"pid",o),"eid",r),"eno",t),"so",a),"currency",i),"total_price",n);var u=document.createElement("script");u.src=c,document.body.appendChild(u),logPrinter_A8("[a8lineCallback] \u30b3\u30fc\u30eb\u30d0\u30c3\u30af\u6642\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3092\u9001\u4fe1\u3057\u307e\u3057\u305f "+c,"DEBUG");var _=getCookie_A8("_a8",s),d=(new A8salesCookieRepository).removeA8salesCookie(_);logPrinter_A8("[a8lineCallback] cookie\u3092\u524a\u9664\u3057\u307e\u3057\u305f a8key:"+_+" resultRemoveA8salesCookie:"+d,"DEBUG"),logPrinter_A8("[a8lineCallback] a8lineCallback\u306e\u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059 "+JSON.stringify(e),"INFO")}else logPrinter_A8("[a8lineCallback] total_price\u306e\u5024\u304c\u7121\u52b9\u3067\u3059, \u51e6\u7406\u3092\u7d42\u4e86\u3057\u307e\u3059 "+n,"ERROR")}getParamValue_A8("a8")&&logPrinter_A8("Set cookie :"+cookieSetting_A8("_a8",getParamValue_A8("a8")),"INFO");